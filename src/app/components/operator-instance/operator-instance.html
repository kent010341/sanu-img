<div class="operator-instance" [class.disabled]="!enabled()">
  <div class="instance-glow"></div>
  <div class="instance-content">
    <div class="instance-header">
      <div class="instance-icon">
        <lucide-icon [img]="metadata().icon" [size]="24"></lucide-icon>
      </div>
      <div class="instance-label">{{ metadata().label }}</div>
      <div class="instance-actions">
        <button class="action-button" (click)="toggleEnable()" [title]="enabled() ? 'Disable' : 'Enable'">
          <lucide-icon [img]="enabled() ? Eye : EyeOff" [size]="16"></lucide-icon>
        </button>
        <button class="action-button delete" (click)="remove()" title="Remove">
          <lucide-icon [img]="Trash2" [size]="16"></lucide-icon>
        </button>
      </div>
    </div>
    @if (configFields().length > 0) {
      <div class="instance-config">
        @for (field of configFields(); track field.key) {
          <div class="config-field">
            <label class="config-label">
              {{ field.label || field.key }}
              @if (field.required) {
                <span class="required-mark">*</span>
              }
            </label>
            @if (field.type === 'select') {
              <select 
                class="config-input"
                [class.placeholder]="!getValue(field.key)"
                [value]="getValue(field.key) ?? ''"
                (change)="updateConfig(field.key, $any($event.target).value, field.type)"
              >
                <option value="" disabled selected hidden>{{ field.placeholder || 'Select an option' }}</option>
                @for (option of field.options; track option.value) {
                  <option [value]="option.value">{{ option.viewValue }}</option>
                }
              </select>
            } @else {
              <input 
                [type]="field.type"
                class="config-input"
                [value]="getValue(field.key) ?? ''"
                [placeholder]="field.placeholder || ''"
                [min]="field.min"
                [max]="field.max"
                (input)="updateConfig(field.key, $any($event.target).value, field.type)"
              />
            }
          </div>
        }
      </div>
    }
  </div>
</div>
